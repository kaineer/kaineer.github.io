<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Тег: admin | Caramel sepulcrum]]></title>
  <link href="http://kaineer.info/blog/categories/admin/atom.xml" rel="self"/>
  <link href="http://kaineer.info/"/>
  <updated>2016-03-29T21:15:47+05:00</updated>
  <id>http://kaineer.info/</id>
  <author>
    <name><![CDATA[Tangerine Cat]]></name>
    <email><![CDATA[kaineer@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Почему bluepill не мониторит мою задачу?]]></title>
    <link href="http://kaineer.info/blog/2013/09/26/daemonize-with-bluepill/"/>
    <updated>2013-09-26T13:09:00+06:00</updated>
    <id>http://kaineer.info/blog/2013/09/26/daemonize-with-bluepill</id>
    <content type="html"><![CDATA[<p>Случается <s>страшное</s> неприятное: падает процесс, поддерживающий работоспособность
вашего приложения и перестаёт ходить почта, обновляться данные и много чего ещё.
Узнаёте вы об этом из вопросов ваших пользователей, большая часть которых сводится
к фразе &ldquo;почему, собственно?&rdquo; Это если опустить все остальные, нецензурные слова.</p>

<p>Но, думаете вы себе, я же всё настроил, сказал <code>bluepill</code>, что вот мои процессы,
запускай их так-то и если процесс умер, запускай его снова? Возможно, что так
оно и есть, но процесс падает и не перезапускается. Так тоже бывает.</p>

<!-- more -->


<p>Что делать в этой ситуации? Первое, очевидное решение, которое мне в голову
пришло гораздо позже, чем должно было, посмотреть лог <code>bluepill</code>.
Там бывает много интересного, например сообщение о том, что приложение
слишком долго стартует и, возможно, оно не демонизировано.</p>

<p>Итак, что можно попробовать, в порядке убывания очевидности:</p>

<ul>
<li>Посмотреть статус процессов запущенных от лица bluepill, командой <code>bluepill status</code> &ndash; если обнаружены процессы со статусом <code>unmonitored</code> &ndash; это то самое, что мы и будем пытаться исправить дальше</li>
<li>Добавить в dsl-блок соответствующих процессов вызов <code>daemonize!</code> если он ещё не там. Это бывает, сам видел</li>
<li>Если и после этого в логе пишется (дальше вольный перевод с английского) &ldquo;Задача слишком долго стартует. Не буду её мониторить&rdquo;, попробуйте добавить <code>start_grace_time 30.seconds</code>. Количество секунд варьируется по запросам запускаемого приложения. Чтобы примерно прикинуть, сколько потребуется, запустите приложение ручками и умножьте время запуска на полтора</li>
<li>Ещё раз посмотрите, что там в логах, проверьте статус, может уже всё хорошо</li>
<li>Вы, кстати, перезагружали <code>bluepill</code> после каждого изменения конфигурации? Если нет, самое время попробовать. Между прочим: команда <code>bluepill stop</code> и последующая <code>bluepill start</code> не приводят к перечитыванию конфигурации. Рекомендую <code>bluepill quit</code> и <code>bluepill load /path/to/config_file</code>.</li>
</ul>


<p>Примерно этот список рекомендаций позволил бы мне сократить время копания
в гугле и попыток &ldquo;заставить всё работать&rdquo; примерно с часа до минут десяти,
или даже пяти :) Удачи.</p>
]]></content>
  </entry>
  
</feed>
